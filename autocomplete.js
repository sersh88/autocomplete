!function(e){if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof module&&void 0!==module.exports){var t=e();Object.defineProperty(exports,"__esModule",{value:!0}),exports.autocomplete=t,exports.default=t}else window.autocomplete=e()}(function(){"use strict";function e(e){function t(){return"none"!==h.display}function n(){y++,m=[],p=void 0,h.display="none"}function o(){for(;v.firstChild;)v.removeChild(v.firstChild);var t=!1,o="#9?$";m.forEach(function(e){e.group&&(t=!0)});var i=function(e){var t=c.createElement("div");return t.textContent=e.label,t};e.render&&(i=e.render);var l=function(e){var t=c.createElement("div");return t.textContent=e,t};if(e.renderGroup&&(l=e.renderGroup),m.forEach(function(t){if(t.group&&t.group!==o){o=t.group;var r=l(t.group);r&&(r.className+=" group",v.appendChild(r))}var a=i(t);a&&(a.addEventListener("click",function(o){e.onSelect(t.item,u),n(),o.preventDefault(),o.stopPropagation()}),t===p&&(a.className+=" selected"),v.appendChild(a))}),m.length<1){if(!e.emptyMsg)return void n();var a=c.createElement("div");a.className="empty",a.textContent=e.emptyMsg,v.appendChild(a)}var f=u.getBoundingClientRect(),d=f.top+u.offsetHeight+c.body.scrollTop;h.top=d+"px",h.left=f.left+"px",h.width=u.offsetWidth+"px",h.maxHeight=window.innerHeight-(f.top+u.offsetHeight)+"px",h.height="auto",h.display="block",r()}function i(i){var r=i.which||i.keyCode||0,l=++y;38!==r&&13!==r&&27!==r&&39!==r&&37!==r&&(40===r&&t()||(u.value.length>=g?e.fetch(u.value,function(e){y===l&&e&&(m=e,p=void 0,o())}):n()))}function r(){var e=v.getElementsByClassName("selected");if(e.length>0){var t=e[0],n=t.previousElementSibling;if(n&&-1!==n.className.indexOf("group")&&!n.previousElementSibling&&(t=n),t.offsetTop<v.scrollTop)v.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,i=v.scrollTop+v.offsetHeight;o>i&&(v.scrollTop+=o-i)}}}function l(){if(m.length<1)p=void 0;else if(p===m[0])p=m[m.length-1];else for(var e=m.length-1;e>0;e--)if(p===m[e]||1===e){p=m[e-1];break}}function a(){if(m.length<1&&(p=void 0),!p||p===m[m.length-1])return void(p=m[0]);for(var e=0;e<m.length-1;e++)if(p===m[e]){p=m[e+1];break}}function f(i){var r=i.which||i.keyCode||0;if(38===r||40===r||27===r){var f=t();if(27===r)n();else{if(!t||m.length<1)return;38===r?l():a(),o()}return i.preventDefault(),void(f&&i.stopPropagation())}13===r&&p&&(e.onSelect(p.item,u),n())}function d(){setTimeout(function(){c.activeElement!==u&&n()},200)}function s(){u.removeEventListener("keydown",f),u.removeEventListener("keyup",i),u.removeEventListener("blur",d),window.removeEventListener("resize",o),n();var e=v.parentNode;e&&e.removeChild(v)}var u,p,c=document,v=c.createElement("div"),h=v.style,m=[],g=e.minLength||2,y=0;if(!e.input)throw new Error("input undefined");return u=e.input,c.body.appendChild(v),v.className="autocomplete "+(e.className||""),h.position="absolute",h.display="none",u.addEventListener("keydown",f),u.addEventListener("keyup",i),u.addEventListener("blur",d),window.addEventListener("resize",o),{destroy:s}}return e});